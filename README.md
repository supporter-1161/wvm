# WireGuard VPN Manager (WVM)

WVM — это bash-скрипт для автоматизированной настройки и управления WireGuard VPN-сервером на VPS с целью безопасного удаленного доступа к домашней сети в режимах Split и Full Tunnel.

## Возможности

*   **Установка и настройка WireGuard VPN-сервера** на VPS.
*   **Поддержка двух режимов:**
    *   **Split Tunnel:** Доступ только к ресурсам домашней сети (например, NAS, принтеры, внутренние сайты).
    *   **Full Tunnel:** Весь интернет-трафик клиента направляется через VPS (аналогичен обычному VPN), при этом остается доступ к домашней сети.
*   **Управление клиентами:** добавление, удаление, генерация конфигов (Split и Full).
*   **Настройка *домашнего шлюза* (роутера/шлюза):** генерация конфига для постоянного подключения *домашней сети* к VPS. Это позволяет клиентам, подключенным к VPS, получать доступ ко всем устройствам и ресурсам внутри домашней сети, как если бы они были физически подключены к ней.
*   **Резервное копирование и восстановление** всей конфигурации (включая клиентские и шлюзовые конфиги, ключи).
*   **Мониторинг состояния** VPN-туннеля.
*   **Миграция на новый VPS** с сохранением ключей и IP-адресов клиентов и шлюза.
*   **Автоматическое добавление маршрута** на VPS для корректной доставки трафика до домашней сети через туннель.
*   **Проверка доступности** домашней сети с VPS (включая LAN IP шлюза).

## Требования

*   VPS с Ubuntu 20.04/22.04 (или другой Debian-совместимой ОС).
*   Root-права на VPS.
*   **Постоянное подключение к VPS от *домашнего шлюза*** (роутера или отдельного компьютера), настроенного как WireGuard-клиент. Это *ключевое* требование: шлюз должен быть *всегда* подключен к VPS, чтобы обеспечивать туннелизацию трафика в/из домашней сети.
*   Доступ к настройкам домашнего шлюза для ввода сгенерированного конфига.

## Установка и использование

1.  **Склонируйте репозиторий:**
    ```bash
    git clone https://github.com/your-username/wireguard-vpn-manager.git
    cd wireguard-vpn-manager
    ```
    *(Замените `https://github.com/your-username/wireguard-vpn-manager.git` на актуальный URL вашего репозитория)*

2.  **Сделайте скрипт исполняемым:**
    ```bash
    chmod +x wg-setup.sh
    ```

3.  **Запустите скрипт от имени root:**
    ```bash
    sudo ./wg-setup.sh
    ```

4.  **Следуйте инструкциям в интерактивном меню.**

### Основные шаги настройки:

1.  **Первоначальная настройка:**
    *   Выберите режим (Split или Full).
    *   Укажите порт, пул VPN-адресов, IP домашнего DNS в VPN, диапазон домашней сети.
    *   Введите публичный IP VPS и имя публичного интерфейса (может быть определено автоматически).
    *   Скрипт установит WireGuard, сгенерирует ключи, создаст конфигурацию сервера (`wg0.conf`) и включит автозапуск.
2.  **Настройка домашнего шлюза:**
    *   Введите имя, WireGuard IP (по умолчанию IP DNS), LAN IP и имя LAN интерфейса шлюза.
    *   Скрипт сгенерирует конфиг (`wg-<имя>.conf`) для шлюза и обновит конфигурацию сервера. Этот конфиг содержит настройки для *постоянного* подключения шлюза к VPS.
    *   Скопируйте сгенерированный конфиг на *домашний шлюз* и настройте его там согласно инструкции в консоли. После этого *домашняя сеть* будет "подключена" к VPS через этот туннель.
3.  **Управление клиентами:**
    *   Добавляйте/удаляйте клиентов.
    *   Для каждого клиента генерируются два конфига: `имя-split.conf` и `имя-full.conf`.
    *   Раздайте соответствующий конфиг пользователю для подключения. После подключения клиент сможет взаимодействовать с *домашней сетью* через шлюз, подключенный к VPS.

## Структура репозитория
